{"version":3,"file":"N3StoreIterator.js","sourceRoot":"","sources":["N3StoreIterator.ts"],"names":[],"mappings":";;;AAAA,iDAAiD;AAIjD,MAAa,eAAgB,SAAQ,gCAA0B;IAO7D,YAAmB,KAAU,EAAE,OAAkB,EAAE,SAAoB,EAAE,MAAiB,EAAE,KAAgB;QAC1G,KAAK,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,GAAG,eAAe,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;QACzD,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;QAC7D,IAAI,CAAC,MAAM,GAAG,eAAe,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;QACvD,IAAI,CAAC,KAAK,GAAG,eAAe,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAErD,MAAM,UAAU,GAAW,KAAK,CAAC,UAAU,CACzC,eAAe,CAAC,gBAAgB,CAAC,OAAO,CAAC,EACzC,eAAe,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAC3C,eAAe,CAAC,gBAAgB,CAAC,MAAM,CAAC,EACxC,eAAe,CAAC,gBAAgB,CAAC,KAAK,CAAC,CACxC,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC;IAC/C,CAAC;IAEM,MAAM,CAAC,gBAAgB,CAAC,IAAe;QAC5C,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;IAC7D,CAAC;IAEM,KAAK,CAAC,KAAa,EAAE,IAAgB;QAC1C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAc,EAAE,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EACrD,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,KAAK,CAAC,CAAC;QACd,IAAI,EAAE,CAAC;QACP,IAAI,CAAC,KAAK,EAAE,CAAC;IACf,CAAC;CACF;AArCD,0CAqCC","sourcesContent":["import { BufferedIterator } from 'asynciterator';\nimport type { Store } from 'n3';\nimport type * as RDF from 'rdf-js';\n\nexport class N3StoreIterator extends BufferedIterator<RDF.Quad> {\n  protected readonly store: Store;\n  protected readonly subject: RDF.Term | null;\n  protected readonly predicate: RDF.Term | null;\n  protected readonly object: RDF.Term | null;\n  protected readonly graph: RDF.Term | null;\n\n  public constructor(store: any, subject?: RDF.Term, predicate?: RDF.Term, object?: RDF.Term, graph?: RDF.Term) {\n    super({ autoStart: false });\n    this.store = store;\n    this.subject = N3StoreIterator.nullifyVariables(subject);\n    this.predicate = N3StoreIterator.nullifyVariables(predicate);\n    this.object = N3StoreIterator.nullifyVariables(object);\n    this.graph = N3StoreIterator.nullifyVariables(graph);\n\n    const totalItems: number = store.countQuads(\n      N3StoreIterator.nullifyVariables(subject),\n      N3StoreIterator.nullifyVariables(predicate),\n      N3StoreIterator.nullifyVariables(object),\n      N3StoreIterator.nullifyVariables(graph),\n    );\n    this.setProperty('metadata', { totalItems });\n  }\n\n  public static nullifyVariables(term?: RDF.Term): RDF.Term | null {\n    return !term || term.termType === 'Variable' ? null : term;\n  }\n\n  public _read(count: number, done: () => void): void {\n    this.store.forEach((quad: RDF.Quad) => this._push(quad),\n      this.subject,\n      this.predicate,\n      this.object,\n      this.graph);\n    done();\n    this.close();\n  }\n}\n"]}